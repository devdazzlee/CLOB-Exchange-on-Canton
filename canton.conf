// Canton Configuration File
// This file configures the Canton participant node, including CORS settings
// 
// IMPORTANT: This file must be on the Canton SERVER, not in your project
// Since you're using participant.dev.canton.wolfedgelabs.com (remote node),
// you need to contact Wolf Edge Labs to add this configuration

canton {
  // Participant configuration
  participants {
    participant {
      // API server configuration
      api {
        // CORS Configuration - THIS IS WHERE CORS IS SET
        cors {
          // List of allowed origins (your frontend domains)
          allowed-origins = [
            "https://clob-exchange-on-canton.vercel.app",  // Production frontend
            "http://localhost:3000",                        // Development
            "http://localhost:5173"                         // Vite dev server
          ]
          
          // Allowed HTTP methods
          allowed-methods = [
            "GET",
            "POST",
            "PUT",
            "DELETE",
            "OPTIONS"
          ]
          
          // Allowed request headers
          allowed-headers = [
            "Content-Type",
            "Authorization",
            "X-Requested-With"
          ]
          
          // Allow credentials (cookies, auth headers)
          allow-credentials = true
          
          // Max age for preflight cache (in seconds)
          max-age = 86400
        }
        
        // API server address and port
        address = "0.0.0.0"
        port = 8080
        
        // Enable HTTPS
        tls {
          cert-chain-file = "/path/to/cert.pem"
          private-key-file = "/path/to/key.pem"
        }
      }
      
      // Ledger API configuration
      ledger-api {
        address = "0.0.0.0"
        port = 6865
      }
      
      // Storage configuration
      storage {
        type = "postgres"
        config {
          url = "jdbc:postgresql://localhost:5432/canton"
          user = "canton"
          password = "canton"
        }
      }
    }
  }
  
  // Domain configuration
  domains {
    domain {
      public-api {
        cors {
          allowed-origins = [
            "https://clob-exchange-on-canton.vercel.app"
          ]
          allowed-methods = ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
          allowed-headers = ["Content-Type", "Authorization"]
          allow-credentials = true
        }
      }
    }
  }
}


