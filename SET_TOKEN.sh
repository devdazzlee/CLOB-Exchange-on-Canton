#!/bin/bash

# Script to set JWT token in frontend/.env

TOKEN="eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJDdjhRQVpEa3pYTlVvSXdNTnpZQWxBSmlBWlUtbmlvelV4VG96R0I4eXM0In0.eyJleHAiOjE3NjcyMDEwMzEsImlhdCI6MTc2NzE5OTIzMSwiYXV0aF90aW1lIjoxNzY3MTgxMjc1LCJqdGkiOiJvZnJ0cnQ6MWE1NGUxZWMtOGI4Mi03YTk1LTBhYjYtMGVkMGRlODcxM2Y3IiwiaXNzIjoiaHR0cHM6Ly9rZXljbG9hay53b2xmZWRnZWxhYnMuY29tOjg0NDMvcmVhbG1zL2NhbnRvbi1kZXZuZXQiLCJhdWQiOlsiaHR0cHM6Ly9jYW50b24ubmV0d29yay5nbG9iYWwiLCJodHRwczovL3ZhbGlkYXRvci13YWxsZXQudGFpbGViNGY1Ni50cy5uZXQiLCJodHRwczovL3dhbGxldC52YWxpZGF0b3IuZGV2LmNhbnRvbi53b2xmZWRnZWxhYnMuY29tIiwiYWNjb3VudCJdLCJzdWIiOiI4MTAwYjJkYi04NmNmLTQwYTEtODM1MS01NTQ4M2MxNTFjZGMiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiI0cm9oOVg3eTRUeVQ4OWZlSnU3QW5NMnNNWmJSOXhoNyIsInNpZCI6Ijk4ODRmMTYwLTZkNDctNGU5YS1hMGZhLTBmOTc0ZmI2ZDkzMyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cHM6Ly9zeW5jaW5zaWdodHMtYXBwLmRldi5jYW50b24ud29sZmVkZ2VsYWJzLmNvbSIsImh0dHBzOi8vd2FsbGV0Mi52YWxpZGF0b3IuZGV2LmNhbnRvbi53b2xmZWRnZWxhYnMuY29tIiwiaHR0cHM6Ly93YWxsZXQxLnZhbGlkYXRvci5kZXYuY2FudG9uLndvbGZlZGdlbGFicy5jb20iLCJodHRwczovL3dhbGxldC52YWxpZGF0b3Iud29sZmVkZ2VsYWJzLmNvbSIsImh0dHBzOi8vd2FsbGV0LnZhbGlkYXRvci5kZXYuY2FudG9uLndvbGZlZGdlbGFicy5jb20iLCJodHRwczovL3ZhbGlkYXRvci13YWxsZXQtY2FudG9uLWRldm5ldC50YWlsZWI0ZjU2LnRzLm5ldCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1jYW50b24tZGV2bmV0Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIG9mZmxpbmVfYWNjZXNzIHByb2ZpbGUgZGFtbF9sZWRnZXJfYXBpIHdhbGxldF9hdWRpZW5jZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiWm95YSBNdWhhbW1hZCIsInByZWZlcnJlZF91c2VybmFtZSI6InpveWEiLCJnaXZlbl9uYW1lIjoiWm95YSIsImZhbWlseV9uYW1lIjoiTXVoYW1tYWQiLCJlbWFpbCI6InpveWFtdWhhbW1hZDk5QGdtYWlsLmNvbSJ9.zeiAtQHWrJEtiHhFY4hEl1H_7j7oQTvXBDa5t39YJcnjFrOM2N8Wx3c50UejJTmrnVyvMJqgBMYbFgsPW4lcvFMNZbZ_lFkc0rb3omkjcLDLpBZV0dVnT5YSpwG7QKePCiP3qssoZl-k11_TPT7goKzXjVDJW1bsbAbKfjuF0-MBpDWaRAmVXsDUmkA9wKXExiX2ULfLekyus0h9RDTyB0L8qGARLk7Z3cq9GO8Joi1zb23x_SV5RZXgohaFnu5cmOB19Z7em20jhPxYFIT-tFQiR2x0Fnm8BrCM88fFwOJ_7QVT-PUyrodmULQ-Q26xe79BMP2ZRQQM-AfYrRd9Mw"

echo "Setting JWT token in frontend/.env..."
cd frontend
echo "VITE_CANTON_JWT_TOKEN=$TOKEN" > .env
echo "✅ Token set in frontend/.env"
echo ""
echo "⚠️  NOTE: The token still returns 403 when tested directly."
echo "   This suggests it may need additional permissions in Keycloak."
echo ""
echo "To test in browser:"
echo "1. Open browser console (F12)"
echo "2. Run: localStorage.setItem('canton_jwt_token', 'TOKEN_HERE')"
echo "3. Refresh the page"
echo ""
echo "See SET_TOKEN_IN_BROWSER.md for detailed instructions."

