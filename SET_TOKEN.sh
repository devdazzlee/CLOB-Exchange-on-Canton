#!/bin/bash

# Script to set JWT token in frontend/.env

TOKEN="eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJDdjhRQVpEa3pYTlVvSXdNTnpZQWxBSmlBWlUtbmlvelV4VG96R0I4eXM0In0.eyJleHAiOjE3NjcyNzMyMTksImlhdCI6MTc2NzI3MTQxOSwiYXV0aF90aW1lIjoxNzY3MjY3NzcyLCJqdGkiOiJvZnJ0cnQ6ZTE2YzBiYjgtNDRmNC03ZGM3LTcwN2ItY2ZjMzRiMjJjZGE5IiwiaXNzIjoiaHR0cHM6Ly9rZXljbG9hay53b2xmZWRnZWxhYnMuY29tOjg0NDMvcmVhbG1zL2NhbnRvbi1kZXZuZXQiLCJhdWQiOlsiaHR0cHM6Ly9jYW50b24ubmV0d29yay5nbG9iYWwiLCJodHRwczovL3ZhbGlkYXRvci13YWxsZXQudGFpbGViNGY1Ni50cy5uZXQiLCJodHRwczovL3dhbGxldC52YWxpZGF0b3IuZGV2LmNhbnRvbi53b2xmZWRnZWxhYnMuY29tIiwiYWNjb3VudCJdLCJzdWIiOiI4MTAwYjJkYi04NmNmLTQwYTEtODM1MS01NTQ4M2MxNTFjZGMiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiI0cm9oOVg3eTRUeVQ4OWZlSnU3QW5NMnNNWmJSOXhoNyIsInNpZCI6IjQ0YzE1NWIwLWE0NDItNDQ5MC04Y2I4LTVlY2IwNmY2ZTVkYyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cHM6Ly9zeW5jaW5zaWdodHMtYXBwLmRldi5jYW50b24ud29sZmVkZ2VsYWJzLmNvbSIsImh0dHBzOi8vd2FsbGV0Mi52YWxpZGF0b3IuZGV2LmNhbnRvbi53b2xmZWRnZWxhYnMuY29tIiwiaHR0cHM6Ly93YWxsZXQxLnZhbGlkYXRvci5kZXYuY2FudG9uLndvbGZlZGdlbGFicy5jb20iLCJodHRwczovL3dhbGxldC52YWxpZGF0b3Iud29sZmVkZ2VsYWJzLmNvbSIsImh0dHBzOi8vd2FsbGV0LnZhbGlkYXRvci5kZXYuY2FudG9uLndvbGZlZGdlbGFicy5jb20iLCJodHRwczovL3ZhbGlkYXRvci13YWxsZXQtY2FudG9uLWRldm5ldC50YWlsZWI0ZjU2LnRzLm5ldCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy1jYW50b24tZGV2bmV0Iiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIG9mZmxpbmVfYWNjZXNzIHByb2ZpbGUgZGFtbF9sZWRnZXJfYXBpIHdhbGxldF9hdWRpZW5jZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiWm95YSBNdWhhbW1hZCIsInByZWZlcnJlZF91c2VybmFtZSI6InpveWEiLCJnaXZlbl9uYW1lIjoiWm95YSIsImZhbWlseV9uYW1lIjoiTXVoYW1tYWQiLCJlbWFpbCI6InpveWFtdWhhbW1hZDk5QGdtYWlsLmNvbSJ9.fPza64lfbyAXbx-yPtOjoUf9jxeEoDV-VNabrfOYnrhdXDyT-ZM3Gtop42sXWbFCXRdjjnbhvrYTgKnqyyra1lUpdKdN-p6QQbuwjL7yJoah_5CXEQGMa0hL7Acent-BgVadTEp8SuPB_CUTC2QLguR9-SoyxN-9OugMvCiX1wrm2FMEiA2Ps3sXzevelO94PM01yljw_gNZbp9BizwP4LgIG0n0yDW6RzBZYEzGhrbRLoh5eLyWHiiLaWbhWWLlpz0MBcnTFkVln5qFNs6Rqo__nr9iPM48BmxLWmwCjCnN5oqIRUfzhT58_LOfm3GDfcZh-h7Cp-IHrt1QlLdyjQ"

echo "Setting JWT token in frontend/.env..."
cd frontend
echo "VITE_CANTON_JWT_TOKEN=$TOKEN" > .env
echo "✅ Token set in frontend/.env"
echo ""
echo "⚠️  NOTE: The token still returns 403 when tested directly."
echo "   This suggests it may need additional permissions in Keycloak."
echo ""
echo "To test in browser:"
echo "1. Open browser console (F12)"
echo "2. Run: localStorage.setItem('canton_jwt_token', 'TOKEN_HERE')"
echo "3. Refresh the page"
echo ""
echo "See SET_TOKEN_IN_BROWSER.md for detailed instructions."


